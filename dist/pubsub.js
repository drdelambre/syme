"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pub=pub,exports.sub=sub,exports.unsub=unsub,exports.clear=clear,exports.channels=channels;var _setImmediate=require("./internal/setImmediate.js"),_setImmediate2=_interopRequireDefault(_setImmediate),_generateTopic=require("./internal/generateTopic.js"),_generateTopic2=_interopRequireDefault(_generateTopic);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var cache={};function cleanPathArgs(e,t,a){var c=t.regexp.exec(e).slice(1),n=void 0,r=void 0;for(n=0;n<c.length;n++)r=parseFloat(c[n]),isNaN(r)||(c[n]=r);return c.concat(a)}function createAsyncPub(e,t){(0,_setImmediate2.default)(function(){e.apply(e,t)})}function pub(e){for(var t=void 0,a=void 0,c=void 0,n=arguments.length,r=Array(1<n?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];for(a in cache)if(cache[a].regexp.test(e))for(c=cleanPathArgs(e,cache[a],r),t=0;t<cache[a].subs.length;t++)createAsyncPub(cache[a].subs[t],c)}function sub(e,t){var a=(0,_generateTopic2.default)(e);if("function"==typeof t)return cache.hasOwnProperty(a.path)||(cache[a.path]=a),cache[a.path].subs.push(t),[a.path,t]}function unsub(e,t){var a=(0,_generateTopic2.default)(e),c=void 0;if(cache.hasOwnProperty(a.path))for(c=0;c<cache[a.path].subs.length;c++)cache[a.path].subs[c]===t&&cache[a.path].subs.splice(c,1)}function clear(){cache={}}function channels(){var e=[],t=void 0;for(t in cache)e.push(cache[t].topic);console.log("Subscribed Channels:\n\t"+e.sort().join("\n\t"))}